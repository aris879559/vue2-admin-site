{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Mock from 'mockjs';\nimport Cookie from 'js-cookie';\nimport { getMenu } from '../api/';\nexport default {\n  data() {\n    return {\n      // 登陆数据\n      ruleForm: {\n        username: '',\n        password: ''\n      },\n      // 校验规则\n      rules: {\n        username: [{\n          required: true,\n          message: '请输入用户名',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          message: '请输入密码',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    // 登录\n    submit() {\n      // // token信息\n      // const token = Mock.Random.guid()\n      // // token信息存入cookie用于不同页面间的通信\n      // Cookie.set('token', token)\n\n      // 校验通过\n      this.$refs.ruleForm.validate(valid => {\n        if (valid) {\n          getMenu(this.ruleForm).then(({\n            data\n          }) => {\n            // console.log(data)\n            if (data.code === 20000) {\n              // token信息存入cookie用于不同页面间的通信\n              Cookie.set('token', data.data.token);\n\n              // 获取菜单的数据，存入store中\n              this.$store.commit('setMenu', data.data.menu);\n              this.$store.commit('addMenu', this.$router);\n\n              // 跳转到首页\n              this.$router.push('/home');\n            } else {\n              this.$message.error(data.data.message);\n            }\n          });\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["Mock","Cookie","getMenu","data","ruleForm","username","password","rules","required","message","trigger","methods","submit","$refs","validate","valid","then","code","set","token","$store","commit","menu","$router","push","$message","error"],"sources":["src/views/Login.vue"],"sourcesContent":["<template>\r\n  <el-form ref=\"ruleForm\" label-width=\"70px\" :inline=\"true\" class=\"login-container\" :model=\"ruleForm\" :rules=\"rules\">\r\n    <h3 class=\"login_title\">用户登录</h3>\r\n    <el-form-item label=\"用户名\" prop=\"username\">\r\n      <el-input v-model=\"ruleForm.username\" placeholder=\"请输入账号\"></el-input>\r\n    </el-form-item>\r\n    <el-form-item label=\"密码\" prop=\"password\">\r\n      <el-input type=\"password\" show-password v-model=\"ruleForm.password\" placeholder=\"请输入密码\"></el-input>\r\n    </el-form-item>\r\n    <el-form-item >\r\n      <el-button @click=\"submit\" style=\"margin-left: 105px;margin-top: 10px;\" type=\"primary\">登录</el-button>\r\n    </el-form-item>\r\n  </el-form>\r\n</template>\r\n<script>\r\nimport Mock from 'mockjs'\r\nimport Cookie from 'js-cookie'\r\nimport { getMenu } from '../api/'\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 登陆数据\r\n      ruleForm: {\r\n        username: '',\r\n        password: '',\r\n      },\r\n      // 校验规则\r\n      rules: {\r\n        username: [\r\n          { required: true, message: '请输入用户名', trigger: 'blur' }\r\n        ],\r\n        password: [\r\n          { required: true, message: '请输入密码', trigger: 'blur' }\r\n        ],\r\n      },\r\n    }\r\n  },\r\n  methods: {\r\n    // 登录\r\n    submit() {\r\n      // // token信息\r\n      // const token = Mock.Random.guid()\r\n      // // token信息存入cookie用于不同页面间的通信\r\n      // Cookie.set('token', token)\r\n\r\n      // 校验通过\r\n      this.$refs.ruleForm.validate((valid) => {\r\n        if (valid) {\r\n          getMenu(this.ruleForm).then(({ data }) => {\r\n            // console.log(data)\r\n            if (data.code === 20000) {\r\n              // token信息存入cookie用于不同页面间的通信\r\n              Cookie.set('token', data.data.token)\r\n\r\n              // 获取菜单的数据，存入store中\r\n              this.$store.commit('setMenu', data.data.menu)\r\n              this.$store.commit('addMenu', this.$router)\r\n\r\n              // 跳转到首页\r\n              this.$router.push('/home')\r\n            } else {\r\n              this.$message.error(data.data.message);\r\n            }\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.login-container {\r\n  width: 350px;\r\n  border: 6px solid #eaeaea;\r\n  margin: 180px auto;\r\n  padding: 35px 35px 15px 35px;\r\n  border-radius: 15px;\r\n  background-color: #fff;\r\n  box-shadow: 0 0 25px #cac6c6;\r\n  box-sizing: border-box;\r\n  .login_title {\r\n    color: #505458;\r\n    // 左右居中\r\n    text-align: center;\r\n    margin-bottom: 40px;\r\n  }\r\n  // .login_submit {\r\n  //   margin: 10px auto 0 auto;\r\n  // }\r\n  .el-input {\r\n    width: 198px;\r\n    // margin-bottom: 20px;\r\n  }\r\n}\r\n</style>"],"mappings":";AAeA,OAAAA,IAAA;AACA,OAAAC,MAAA;AACA,SAAAC,OAAA;AACA;EACAC,KAAA;IACA;MACA;MACAC,QAAA;QACAC,QAAA;QACAC,QAAA;MACA;MACA;MACAC,KAAA;QACAF,QAAA,GACA;UAAAG,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,EACA;QACAJ,QAAA,GACA;UAAAE,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MAEA;IACA;EACA;EACAC,OAAA;IACA;IACAC,OAAA;MACA;MACA;MACA;MACA;;MAEA;MACA,KAAAC,KAAA,CAAAT,QAAA,CAAAU,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACAb,OAAA,MAAAE,QAAA,EAAAY,IAAA;YAAAb;UAAA;YACA;YACA,IAAAA,IAAA,CAAAc,IAAA;cACA;cACAhB,MAAA,CAAAiB,GAAA,UAAAf,IAAA,CAAAA,IAAA,CAAAgB,KAAA;;cAEA;cACA,KAAAC,MAAA,CAAAC,MAAA,YAAAlB,IAAA,CAAAA,IAAA,CAAAmB,IAAA;cACA,KAAAF,MAAA,CAAAC,MAAA,iBAAAE,OAAA;;cAEA;cACA,KAAAA,OAAA,CAAAC,IAAA;YACA;cACA,KAAAC,QAAA,CAAAC,KAAA,CAAAvB,IAAA,CAAAA,IAAA,CAAAM,OAAA;YACA;UACA;QACA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}